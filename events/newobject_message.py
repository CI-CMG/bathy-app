import json
#msg = {'Records': [{'EventSource': 'aws:sns', 'EventVersion': '1.0', 'EventSubscriptionArn': 'arn:aws:sns:us-east-1:709902155096:NewDCDBBathymetryObject:95e85ea8-844a-4317-878c-00ada50aa943', 'Sns': {'Type': 'Notification', 'MessageId': 'c7b3de0b-1e66-57dc-93f1-83e7093a0395', 'TopicArn': 'arn:aws:sns:us-east-1:709902155096:NewDCDBBathymetryObject', 'Subject': 'Amazon S3 Notification', 'Message': '{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-east-1","eventTime":"2023-12-07T18:55:23.173Z","eventName":"ObjectCreated:Put","userIdentity":{"principalId":"AWS:AIDA2KSLXHVMNXFLE4OIY"},"requestParameters":{"sourceIPAddress":"73.229.72.157"},"responseElements":{"x-amz-request-id":"GPSMMM0AKVRB2DED","x-amz-id-2":"9y04TyLEoYknllqtWDY2iR/Y+uMn0g8Xj9F8xjDOXh4J+c8xGqQ19fskzNz/6ZK6qYRS30vp/k9w9TsBHFnH8vbfXnKlpWlF"},"s3":{"s3SchemaVersion":"1.0","configurationId":"0ddbebf4-8738-4b07-b089-6a3312d8d19b","bucket":{"name":"noaa-dcdb-bathymetry-pds","ownerIdentity":{"principalId":"A1FTB9C2R32E6T"},"arn":"arn:aws:s3:::noaa-dcdb-bathymetry-pds"},"object":{"key":"csb/docs/test.txt","size":12,"eTag":"6f5902ac237024bdd0c176cb93063dc4","sequencer":"006572151B17FD26EB"}}}]}', 'Timestamp': '2023-12-07T18:55:24.857Z', 'SignatureVersion': '1', 'Signature': 'GKB86Bip4ebmztK4DPwJDyb7c4i0ut83xSdvOdHdwWx9NJm4NTOY7t/2G6m3VUiy/UldQI0GCkpaqy6tkirSWh+PdVhvDJSUL2RrYst5SM6anUDxIR2lB9F7Glxq1/eoLJCw8xZ7MP8UQIUMexYjoWKYbuzQ5sA9nMoDZcUf/E1MCCncJL7F0NybpqStI+sWY5eYi5NKEmBHZUH9TxN/IMK8cEItMPHMgGvuweNSBZtm7NMLRpGIVllJmvIcys93NJNe6is1Dsi59aoD1gNDE1C1SQXeAFKft+Q7+bo51M0k0oCQXiK0DwDzzpybBQKnh/awzaAoXQnxfIwLHNgV/Q==', 'SigningCertUrl': 'https://sns.us-east-1.amazonaws.com/SimpleNotificationService-01d088a6f77103d0fe307c0069e40ed6.pem', 'UnsubscribeUrl': 'https://sns.us-east-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-east-1:709902155096:NewDCDBBathymetryObject:95e85ea8-844a-4317-878c-00ada50aa943', 'MessageAttributes': {}}}]}
msg = {'Records': [{'EventSource': 'aws:sns', 'EventVersion': '1.0', 'EventSubscriptionArn': 'arn:aws:sns:us-east-1:709902155096:RemoveDCDBObject:46aac78d-86ab-48c7-bc81-758cf6d63e1e', 'Sns': {'Type': 'Notification', 'MessageId': '22d44ef3-dd69-599d-ac6b-131fcad356c4', 'TopicArn': 'arn:aws:sns:us-east-1:709902155096:RemoveDCDBObject', 'Subject': 'Amazon S3 Notification', 'Message': '{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-east-1","eventTime":"2023-12-07T18:56:57.044Z","eventName":"ObjectRemoved:Delete","userIdentity":{"principalId":"AWS:AIDA2KSLXHVMNXFLE4OIY"},"requestParameters":{"sourceIPAddress":"73.229.72.157"},"responseElements":{"x-amz-request-id":"YSGHHWR7GH9ZY4DN","x-amz-id-2":"7VzuNnVumJQkDojAKq7OI+itklcr70cXZR2BRVTMsCMcaJmTPRyfZSvGb2PUf9MFW2NwFoWCQ3Yk+qjjKqA+NH6wobDQEZv+"},"s3":{"s3SchemaVersion":"1.0","configurationId":"Remove Objects","bucket":{"name":"noaa-dcdb-bathymetry-pds","ownerIdentity":{"principalId":"A1FTB9C2R32E6T"},"arn":"arn:aws:s3:::noaa-dcdb-bathymetry-pds"},"object":{"key":"csb/docs/test.txt","sequencer":"0065721579099D118C"}}}]}', 'Timestamp': '2023-12-07T18:56:58.425Z', 'SignatureVersion': '1', 'Signature': 'JH00AvTw/qHw//8cPliruTvDYzGe6tfJ8TKfItPykptqlsv1MTW4fM/naAVzwuGbc5QRcgNM4X9j+TU4jmN1gga/m/jt2sAyLQE37P/6MR2BjflC97Jb4eUvOC0iWYRKrC6UcsyzrgUPbOPyH/d3d+LMsxi54ACPlBtRdB4OtxAjTPWZkhxL0kASrGm/WJ3EaSxdncToAkgpPw1yxvg70zr0LlwU4R5eJ/RBbwOxI6TjLTwRRLPSRMdPWgHrzbeTp1NEJlxxGpeFrxdfmBpUV8OdT3P0NoyutaTQp032zRab89B4xNIrf4W9C2zV0jsWuIgQLOYyrv5RWBkM3Ouu9A==', 'SigningCertUrl': 'https://sns.us-east-1.amazonaws.com/SimpleNotificationService-01d088a6f77103d0fe307c0069e40ed6.pem', 'UnsubscribeUrl': 'https://sns.us-east-1.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-east-1:709902155096:RemoveDCDBObject:46aac78d-86ab-48c7-bc81-758cf6d63e1e', 'MessageAttributes': {}}}]}
msg = {'Records': [{'EventSource': 'aws:sns', 'EventVersion': '1.0', 'EventSubscriptionArn': 'arn:aws:sns:us-west-2:619726840331:jccRemoveObject:ad022980-5d43-48fc-a4fd-9f8c32a9529b', 'Sns': {'Type': 'Notification', 'MessageId': '4178c026-412f-5ce7-9ae7-9dca687d74c9', 'TopicArn': 'arn:aws:sns:us-west-2:619726840331:jccRemoveObject', 'Subject': 'Amazon S3 Notification', 'Message': '{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-west-2","eventTime":"2023-12-07T20:12:01.596Z","eventName":"ObjectRemoved:Delete","userIdentity":{"principalId":"AWS:AROAZASUZEIFXOK6VOQWQ:joca5730@colorado.edu"},"requestParameters":{"sourceIPAddress":"198.11.28.48"},"responseElements":{"x-amz-request-id":"YD16HEAQCNFGQKXT","x-amz-id-2":"W++wgAkeKbXR6pUSR7avz4MhM0V6ptdwONs0KEW9Pt/HT7NDYiLFUmR3UGOd3EYbhhodecy8QujDwmeUdA4spupq6BL8uzov"},"s3":{"s3SchemaVersion":"1.0","configurationId":"removeObject","bucket":{"name":"jcc-object-event-test","ownerIdentity":{"principalId":"A1D95GOQ3QBL4X"},"arn":"arn:aws:s3:::jcc-object-event-test"},"object":{"key":"test.txt","sequencer":"00657227119185D178"}}}]}', 'Timestamp': '2023-12-07T20:12:02.316Z', 'SignatureVersion': '1', 'Signature': 'IFlMUnIP2m8/tzhRoWAHDdlXx0JOSaP5xldP21lkR76nXUMiyWlCInZ+2JnKrj0eQOKk11h1GTEotGghDdcAIT1xDfkN2XlniJFVU/no1dSo1pWo8xI/TN/UuPpjNQbebQZvPd2vhJGm1IZtmpAwH0MylA4Tml1isax1i34YvP2MEguxak4i8Z6w/779W6C7IVl9nkmldK6Q8Y4kNnamuUWJXXensJdCzPG2S5YjZFrCx9G8x458/zSAZgJk+snCDvOlN1Vo3999imQFhrHYnBeA1VQ4EnfPVWU2T3poqOlrf87s2337ISleJR4e8npEEFx/wJuLV5dP/uvk5bsN6A==', 'SigningCertUrl': 'https://sns.us-west-2.amazonaws.com/SimpleNotificationService-01d088a6f77103d0fe307c0069e40ed6.pem', 'UnsubscribeUrl': 'https://sns.us-west-2.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-west-2:619726840331:jccRemoveObject:ad022980-5d43-48fc-a4fd-9f8c32a9529b', 'MessageAttributes': {}}}]}
msg = {'Records': [{'EventSource': 'aws:sns', 'EventVersion': '1.0', 'EventSubscriptionArn': 'arn:aws:sns:us-west-2:619726840331:jccNewObject:e094826b-272c-4e95-8872-949ff4eeee3c', 'Sns': {'Type': 'Notification', 'MessageId': 'c03c1113-8943-5a76-be11-4cffa0675805', 'TopicArn': 'arn:aws:sns:us-west-2:619726840331:jccNewObject', 'Subject': 'Amazon S3 Notification', 'Message': '{"Records":[{"eventVersion":"2.1","eventSource":"aws:s3","awsRegion":"us-west-2","eventTime":"2023-12-07T20:11:15.025Z","eventName":"ObjectCreated:Put","userIdentity":{"principalId":"AWS:AROAZASUZEIFXOK6VOQWQ:joca5730@colorado.edu"},"requestParameters":{"sourceIPAddress":"198.11.28.48"},"responseElements":{"x-amz-request-id":"PE9CZ1W8RC59W4AM","x-amz-id-2":"RkahpLy7TxhFo5Cu9ds1wPcUwmgJ834/Rcc0c+kHd5I4RfOlEJgrIiyy4lMHOIjkhYWq/AytFrp3494SAUBiwiNbG7+BZrPo"},"s3":{"s3SchemaVersion":"1.0","configurationId":"S3NewObject","bucket":{"name":"jcc-object-event-test","ownerIdentity":{"principalId":"A1D95GOQ3QBL4X"},"arn":"arn:aws:s3:::jcc-object-event-test"},"object":{"key":"test.txt","size":12,"eTag":"6f5902ac237024bdd0c176cb93063dc4","sequencer":"00657226E2F95041D2"}}}]}', 'Timestamp': '2023-12-07T20:11:16.629Z', 'SignatureVersion': '1', 'Signature': 'YihNfNasyuuM3BR0QoWSWa33wGesbgXRIE2IJNSvKIfz2B+Xyy2nrLRFlBVSqUM3VvHMBktbYIIcfNiDLXMS8jL2xxK9dZvGR3VqmiEawIxO2jXuA4H2d/Rfb43EVDYmmNU4TdpWfwNiakZoHqCtJSOkTUqaJcs7K9QRes/QPF5W0QqCkyhekZZrx6rTlGowSWyXUu2RpbD9spYjMEkBK9kguODqv+5VVyNv97j74+gKiljh8xPG/JSEhlRT3tku9i9ajbsi21Qt39uPLSsMAw/8YOIyBYeNA1Pimo+W9nWL36vMgMHoXKdBZs7kRYdTab0Bb6wPLNeQ2pDFgcF4UA==', 'SigningCertUrl': 'https://sns.us-west-2.amazonaws.com/SimpleNotificationService-01d088a6f77103d0fe307c0069e40ed6.pem', 'UnsubscribeUrl': 'https://sns.us-west-2.amazonaws.com/?Action=Unsubscribe&SubscriptionArn=arn:aws:sns:us-west-2:619726840331:jccNewObject:e094826b-272c-4e95-8872-949ff4eeee3c', 'MessageAttributes': {}}}]}

print (json.dumps(msg, indent=2))